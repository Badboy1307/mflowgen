#include "common.h"
#include "wsrt.h"
#include <vector>

#include "mtbmark-bin-search-KeyValue.h"
#include "ubmark-bin-search.dat"


//------------------------------------------------------------------------
// bin_search_mtpull
//------------------------------------------------------------------------

__attribute__ ((noinline))
void bin_search_mtpull( int values[], int keys[], int keys_sz,
                        KeyValue kv[], int kv_sz )
{
  WSRT_PARALLEL_FOR2( keys_sz, (values,keys,kv,kv_sz),
  ({
    for ( int i = range.begin(); i < range.end(); i++ ) {

      int key     = keys[i];
      int idx_min = 0;
      int idx_mid = kv_sz/2;
      int idx_max = kv_sz-1;

      bool done = false;
      values[i] = -1;
      do {
        int midkey = kv[idx_mid].key;

        if ( key == midkey ) {
          values[i] = kv[idx_mid].value;
          done = true;
        }

        if ( key > midkey )
          idx_min = idx_mid + 1;
        else if ( key < midkey )
          idx_max = idx_mid - 1;

        idx_mid = ( idx_min + idx_max ) / 2;

      } while ( !done && (idx_min <= idx_max) );

    }
  }))
}


//------------------------------------------------------------------------
// verify_results
//------------------------------------------------------------------------

void verify_results( const char* name,
                     int values[], int ref[], int size )
{
  for ( int i = 0; i < size; i++ ) {
    if ( !( values[i] == ref[i] ) ) {
      test_fail( i, values[i], ref[i] );
      return;
    }
  }
  test_pass();
}

//------------------------------------------------------------------------

int main( int argc, char* argv[] )
{
  // Initialize bare threads (bthread). This must happen as the first
  // thing in main()!

  bthread_init();

  KeyValue kv[] = {
  KeyValue(275,798595),
  KeyValue(878,595),
  KeyValue(1657,542393),
  KeyValue(1664,325578),
  KeyValue(3228,491343),
  KeyValue(3818,165764),
  KeyValue(4202,739097),
  KeyValue(4253,171178),
  KeyValue(5181,782769),
  KeyValue(6341,436425),
  KeyValue(7698,671149),
  KeyValue(11143,589635),
  KeyValue(11316,193967),
  KeyValue(14950,829238),
  KeyValue(16074,170346),
  KeyValue(17944,914024),
  KeyValue(18251,698162),
  KeyValue(18916,982032),
  KeyValue(19092,741715),
  KeyValue(22083,817101),
  KeyValue(22405,518773),
  KeyValue(26000,259119),
  KeyValue(26339,167312),
  KeyValue(29355,856192),
  KeyValue(30040,23860),
  KeyValue(31255,739931),
  KeyValue(31403,572441),
  KeyValue(31638,523771),
  KeyValue(31656,731363),
  KeyValue(31838,413579),
  KeyValue(32269,574345),
  KeyValue(32338,869877),
  KeyValue(33053,802405),
  KeyValue(34243,444519),
  KeyValue(34572,830965),
  KeyValue(34970,210033),
  KeyValue(35059,320642),
  KeyValue(36367,756770),
  KeyValue(37682,602310),
  KeyValue(38659,602370),
  KeyValue(39663,256383),
  KeyValue(41420,45340),
  KeyValue(43407,408225),
  KeyValue(47464,262452),
  KeyValue(48264,762720),
  KeyValue(50083,940979),
  KeyValue(50481,405786),
  KeyValue(53694,496582),
  KeyValue(53726,655206),
  KeyValue(55278,220685),
  KeyValue(56134,846436),
  KeyValue(59197,86812),
  KeyValue(59347,474984),
  KeyValue(59959,576430),
  KeyValue(60142,308327),
  KeyValue(60241,974538),
  KeyValue(60262,45520),
  KeyValue(60564,909208),
  KeyValue(62886,852208),
  KeyValue(65193,463322),
  KeyValue(65356,771944),
  KeyValue(66842,383415),
  KeyValue(72685,651518),
  KeyValue(72854,529664),
  KeyValue(72869,879161),
  KeyValue(73038,545015),
  KeyValue(73183,533532),
  KeyValue(73510,428873),
  KeyValue(73712,690966),
  KeyValue(73749,947764),
  KeyValue(73850,50043),
  KeyValue(76821,121739),
  KeyValue(77255,991853),
  KeyValue(77324,713695),
  KeyValue(78214,335103),
  KeyValue(78263,279293),
  KeyValue(78941,768851),
  KeyValue(79916,495691),
  KeyValue(80322,110018),
  KeyValue(80353,29635),
  KeyValue(81737,94548),
  KeyValue(82394,521573),
  KeyValue(82597,729641),
  KeyValue(86605,376276),
  KeyValue(88992,204562),
  KeyValue(89853,359379),
  KeyValue(90732,266144),
  KeyValue(90745,789200),
  KeyValue(91533,525560),
  KeyValue(93643,320824),
  KeyValue(96538,110019),
  KeyValue(99865,766174),
  KeyValue(100869,972695),
  KeyValue(101637,233599),
  KeyValue(102257,538174),
  KeyValue(102468,463800),
  KeyValue(103797,9347),
  KeyValue(104579,131023),
  KeyValue(105184,517707),
  KeyValue(105562,22556),
  KeyValue(107180,245142),
  KeyValue(107738,436491),
  KeyValue(109083,165413),
  KeyValue(109927,921467),
  KeyValue(110132,475344),
  KeyValue(114529,747968),
  KeyValue(115606,667347),
  KeyValue(116442,985489),
  KeyValue(117237,951753),
  KeyValue(117436,699834),
  KeyValue(118397,526454),
  KeyValue(120176,152562),
  KeyValue(120690,376933),
  KeyValue(122506,35587),
  KeyValue(122949,506819),
  KeyValue(123444,243001),
  KeyValue(123848,70335),
  KeyValue(125365,827817),
  KeyValue(125922,608444),
  KeyValue(125932,607611),
  KeyValue(126030,261862),
  KeyValue(127237,698704),
  KeyValue(129042,137093),
  KeyValue(129609,877796),
  KeyValue(130099,545435),
  KeyValue(130177,625461),
  KeyValue(130427,714709),
  KeyValue(131537,7),
  KeyValue(133293,373661),
  KeyValue(134039,963475),
  KeyValue(135109,253057),
  KeyValue(136994,985847),
  KeyValue(137715,449106),
  KeyValue(138001,857924),
  KeyValue(139194,543948),
  KeyValue(140710,66290),
  KeyValue(141179,829722),
  KeyValue(142021,426497),
  KeyValue(143244,551921),
  KeyValue(144897,693588),
  KeyValue(145992,258829),
  KeyValue(146195,300121),
  KeyValue(146671,554777),
  KeyValue(147533,499741),
  KeyValue(148151,556146),
  KeyValue(148390,311605),
  KeyValue(148703,918435),
  KeyValue(148787,429472),
  KeyValue(149251,57722),
  KeyValue(150311,446489),
  KeyValue(150371,677583),
  KeyValue(150393,986502),
  KeyValue(153604,999116),
  KeyValue(154232,327313),
  KeyValue(155058,641646),
  KeyValue(155413,821333),
  KeyValue(155872,376816),
  KeyValue(157154,351172),
  KeyValue(157731,828354),
  KeyValue(159346,457616),
  KeyValue(159579,162203),
  KeyValue(159757,744104),
  KeyValue(160083,526337),
  KeyValue(160273,70634),
  KeyValue(161419,490817),
  KeyValue(161620,117163),
  KeyValue(161687,143045),
  KeyValue(162198,92173),
  KeyValue(162427,533180),
  KeyValue(163936,200402),
  KeyValue(164599,122220),
  KeyValue(164684,264363),
  KeyValue(165043,729884),
  KeyValue(165406,349269),
  KeyValue(165927,653011),
  KeyValue(166507,359264),
  KeyValue(167285,31187),
  KeyValue(168482,313986),
  KeyValue(169109,292090),
  KeyValue(169960,264661),
  KeyValue(170796,770046),
  KeyValue(171227,911773),
  KeyValue(171379,205341),
  KeyValue(171393,24166),
  KeyValue(172458,332312),
  KeyValue(172927,217062),
  KeyValue(175974,6079),
  KeyValue(176420,442623),
  KeyValue(176880,601010),
  KeyValue(178151,176306),
  KeyValue(178327,287212),
  KeyValue(180408,780221),
  KeyValue(181980,412815),
  KeyValue(186824,425191),
  KeyValue(188275,973355),
  KeyValue(189548,338084),
  KeyValue(189621,54809),
  KeyValue(191670,265734),
  KeyValue(191983,22799),
  KeyValue(192646,303932),
  KeyValue(193147,969666),
  KeyValue(194678,921472),
  KeyValue(196177,886725),
  KeyValue(196307,129481),
  KeyValue(197464,280787),
  KeyValue(197900,907847),
  KeyValue(198079,833474),
  KeyValue(198630,866139),
  KeyValue(199000,796584),
  KeyValue(199757,126030),
  KeyValue(201616,251692),
  KeyValue(202481,485286),
  KeyValue(202964,879645),
  KeyValue(203158,688594),
  KeyValue(203250,389314),
  KeyValue(203913,660927),
  KeyValue(203926,96876),
  KeyValue(204153,594764),
  KeyValue(207209,681335),
  KeyValue(207749,987041),
  KeyValue(209562,116571),
  KeyValue(211342,568109),
  KeyValue(211518,365158),
  KeyValue(212751,159767),
  KeyValue(213546,213852),
  KeyValue(213915,257524),
  KeyValue(214659,926769),
  KeyValue(215248,651646),
  KeyValue(215447,195229),
  KeyValue(215825,389731),
  KeyValue(216245,132814),
  KeyValue(216386,104969),
  KeyValue(217409,857155),
  KeyValue(218624,760826),
  KeyValue(218959,532767),
  KeyValue(220390,785281),
  KeyValue(220515,929149),
  KeyValue(221656,921117),
  KeyValue(221667,230571),
  KeyValue(227488,801167),
  KeyValue(227762,222539),
  KeyValue(228600,41603),
  KeyValue(230269,527412),
  KeyValue(231895,842043),
  KeyValue(232607,200644),
  KeyValue(233691,224801),
  KeyValue(234675,963243),
  KeyValue(235326,971989),
  KeyValue(235402,938254),
  KeyValue(235833,806701),
  KeyValue(236832,328329),
  KeyValue(237746,140848),
  KeyValue(238019,708587),
  KeyValue(238217,834368),
  KeyValue(239910,937897),
  KeyValue(240440,401692),
  KeyValue(242478,27800),
  KeyValue(243010,437510),
  KeyValue(243228,662893),
  KeyValue(244300,947119),
  KeyValue(245427,856502),
  KeyValue(245494,963839),
  KeyValue(246973,126033),
  KeyValue(247025,160007),
  KeyValue(250155,934030),
  KeyValue(250356,843532),
  KeyValue(250654,891786),
  KeyValue(250745,964196),
  KeyValue(252718,287871),
  KeyValue(253661,781356),
  KeyValue(253922,369742),
  KeyValue(254562,101460),
  KeyValue(254957,964851),
  KeyValue(257168,987937),
  KeyValue(259014,974252),
  KeyValue(261778,494630),
  KeyValue(263152,372777),
  KeyValue(264133,344455),
  KeyValue(266286,106043),
  KeyValue(268585,554308),
  KeyValue(269214,389853),
  KeyValue(270701,420198),
  KeyValue(272135,829492),
  KeyValue(272442,481720),
  KeyValue(274588,90990),
  KeyValue(274868,813189),
  KeyValue(274906,237774),
  KeyValue(276393,407049),
  KeyValue(276646,534198),
  KeyValue(276667,917967),
  KeyValue(277198,861621),
  KeyValue(278563,786712),
  KeyValue(279493,744468),
  KeyValue(279691,981988),
  KeyValue(280103,605538),
  KeyValue(280288,538661),
  KeyValue(282155,422459),
  KeyValue(282219,849067),
  KeyValue(282231,466667),
  KeyValue(282827,815331),
  KeyValue(283332,139185),
  KeyValue(284035,692168),
  KeyValue(288654,560914),
  KeyValue(289316,851269),
  KeyValue(289766,472379),
  KeyValue(291166,898036),
  KeyValue(293043,839548),
  KeyValue(294793,550918),
  KeyValue(297022,723763),
  KeyValue(299211,100809),
  KeyValue(301389,4777),
  KeyValue(301462,343148),
  KeyValue(306061,292872),
  KeyValue(306321,233194),
  KeyValue(307525,68263),
  KeyValue(307858,264788),
  KeyValue(310168,686101),
  KeyValue(310327,878878),
  KeyValue(314607,854603),
  KeyValue(314698,854365),
  KeyValue(316007,738996),
  KeyValue(317539,180895),
  KeyValue(318549,529619),
  KeyValue(318777,227007),
  KeyValue(319032,516291),
  KeyValue(320611,415560),
  KeyValue(322150,162867),
  KeyValue(323428,664147),
  KeyValue(325262,110806),
  KeyValue(327227,423890),
  KeyValue(328234,736081),
  KeyValue(329056,467741),
  KeyValue(329434,726443),
  KeyValue(329578,822891),
  KeyValue(330758,338509),
  KeyValue(331174,681164),
  KeyValue(331291,215049),
  KeyValue(332072,876261),
  KeyValue(332868,583705),
  KeyValue(332928,962535),
  KeyValue(333569,140259),
  KeyValue(334306,389500),
  KeyValue(335605,658912),
  KeyValue(338452,838480),
  KeyValue(341847,579362),
  KeyValue(343489,620714),
  KeyValue(343613,41074),
  KeyValue(343817,670098),
  KeyValue(344576,441265),
  KeyValue(345871,670991),
  KeyValue(346431,627794),
  KeyValue(347491,63803),
  KeyValue(349156,352314),
  KeyValue(349782,741616),
  KeyValue(351868,486484),
  KeyValue(352060,362191),
  KeyValue(353126,438290),
  KeyValue(354326,309118),
  KeyValue(355252,978601),
  KeyValue(356334,575852),
  KeyValue(357525,181195),
  KeyValue(357671,377364),
  KeyValue(360967,187978),
  KeyValue(362057,108904),
  KeyValue(362083,605602),
  KeyValue(362400,908690),
  KeyValue(362593,81594),
  KeyValue(365338,991037),
  KeyValue(365339,71063),
  KeyValue(365643,373973),
  KeyValue(368202,432877),
  KeyValue(368562,841576),
  KeyValue(368608,574306),
  KeyValue(370226,258842),
  KeyValue(371465,616610),
  KeyValue(371909,815932),
  KeyValue(373359,465007),
  KeyValue(374249,793382),
  KeyValue(374621,385218),
  KeyValue(375040,261282),
  KeyValue(375437,518437),
  KeyValue(377178,798558),
  KeyValue(377484,113070),
  KeyValue(378366,711571),
  KeyValue(378955,469945),
  KeyValue(380426,512963),
  KeyValue(380608,468101),
  KeyValue(380627,282464),
  KeyValue(382412,345890),
  KeyValue(382821,263662),
  KeyValue(383380,556517),
  KeyValue(384142,500707),
  KeyValue(386707,277585),
  KeyValue(386912,399142),
  KeyValue(387382,282762),
  KeyValue(387725,385814),
  KeyValue(387831,475896),
  KeyValue(388823,81060),
  KeyValue(390932,481429),
  KeyValue(393450,785469),
  KeyValue(396487,262890),
  KeyValue(396655,768393),
  KeyValue(398143,136454),
  KeyValue(399307,703183),
  KeyValue(400522,997881),
  KeyValue(401554,193633),
  KeyValue(402739,698066),
  KeyValue(402783,661891),
  KeyValue(403581,430618),
  KeyValue(403707,211602),
  KeyValue(406749,453228),
  KeyValue(408177,972476),
  KeyValue(408626,717760),
  KeyValue(408766,983305),
  KeyValue(409057,925769),
  KeyValue(409278,279015),
  KeyValue(409957,53752),
  KeyValue(410313,947486),
  KeyValue(412210,858476),
  KeyValue(412836,17517),
  KeyValue(414028,103433),
  KeyValue(414293,2999),
  KeyValue(415100,458524),
  KeyValue(415394,269317),
  KeyValue(416796,161029),
  KeyValue(416839,817065),
  KeyValue(417457,998299),
  KeyValue(417723,319177),
  KeyValue(418165,583115),
  KeyValue(420051,585257),
  KeyValue(421578,83085),
  KeyValue(422552,831523),
  KeyValue(423845,610723),
  KeyValue(424133,883704),
  KeyValue(424335,251527),
  KeyValue(429241,898639),
  KeyValue(430446,929697),
  KeyValue(430824,460250),
  KeyValue(430847,518083),
  KeyValue(431908,599359),
  KeyValue(433928,213567),
  KeyValue(434502,895724),
  KeyValue(435375,642734),
  KeyValue(435772,640354),
  KeyValue(436411,272709),
  KeyValue(436638,707826),
  KeyValue(439150,349939),
  KeyValue(439725,881504),
  KeyValue(441313,588888),
  KeyValue(442370,869187),
  KeyValue(445120,870437),
  KeyValue(446023,215531),
  KeyValue(446865,393017),
  KeyValue(447813,1573),
  KeyValue(448720,839795),
  KeyValue(451851,694856),
  KeyValue(452300,349524),
  KeyValue(452883,522130),
  KeyValue(454478,775715),
  KeyValue(454547,628753),
  KeyValue(455072,539504),
  KeyValue(455199,184355),
  KeyValue(455307,783153),
  KeyValue(455751,694023),
  KeyValue(457732,633691),
  KeyValue(458045,48697),
  KeyValue(458650,755605),
  KeyValue(458913,70950),
  KeyValue(459762,81005),
  KeyValue(460434,321560),
  KeyValue(462244,755843),
  KeyValue(463058,369040),
  KeyValue(464032,259919),
  KeyValue(464445,529747),
  KeyValue(466967,323404),
  KeyValue(467208,930651),
  KeyValue(467917,537303),
  KeyValue(468209,815759),
  KeyValue(469498,436096),
  KeyValue(470330,184593),
  KeyValue(473190,295857),
  KeyValue(473922,468106),
  KeyValue(474320,586986),
  KeyValue(476431,247841),
  KeyValue(476951,953262),
  KeyValue(477640,143302),
  KeyValue(477731,766494),
  KeyValue(477758,801599),
  KeyValue(477804,50602),
  KeyValue(479778,9607),
  KeyValue(483872,498630),
  KeyValue(486470,878412),
  KeyValue(486681,513148),
  KeyValue(486849,407537),
  KeyValue(487047,172576),
  KeyValue(487712,755131),
  KeyValue(488514,252126),
  KeyValue(488943,713422),
  KeyValue(489651,377550),
  KeyValue(491122,544028),
  KeyValue(491840,864609),
  KeyValue(492207,471856),
  KeyValue(493254,98857),
  KeyValue(493976,986642),
  KeyValue(498480,534449),
  KeyValue(499657,450734),
  KeyValue(499773,269917),
  KeyValue(499835,506544),
  KeyValue(501853,824626),
  KeyValue(502274,151216),
  KeyValue(504522,904653),
  KeyValue(505058,655887),
  KeyValue(505955,471262),
  KeyValue(506390,208752),
  KeyValue(509658,292467),
  KeyValue(513273,351015),
  KeyValue(513498,22461),
  KeyValue(513759,575624),
  KeyValue(514434,537425),
  KeyValue(514659,315732),
  KeyValue(515290,718897),
  KeyValue(516531,381954),
  KeyValue(517069,761439),
  KeyValue(517482,674452),
  KeyValue(517595,378444),
  KeyValue(518478,584787),
  KeyValue(519174,441632),
  KeyValue(519303,61731),
  KeyValue(519336,723836),
  KeyValue(519416,383502),
  KeyValue(519988,457161),
  KeyValue(522063,51616),
  KeyValue(522214,803267),
  KeyValue(522807,541710),
  KeyValue(523072,967723),
  KeyValue(523784,107010),
  KeyValue(524987,886031),
  KeyValue(526123,762570),
  KeyValue(526300,405874),
  KeyValue(526928,846166),
  KeyValue(527439,802018),
  KeyValue(528548,135332),
  KeyValue(529700,53461),
  KeyValue(530489,703369),
  KeyValue(530930,554443),
  KeyValue(531427,273251),
  KeyValue(531860,871870),
  KeyValue(534876,349529),
  KeyValue(535956,526181),
  KeyValue(536266,679332),
  KeyValue(536528,232078),
  KeyValue(541796,377315),
  KeyValue(542600,585800),
  KeyValue(542824,600734),
  KeyValue(544022,66849),
  KeyValue(544640,375768),
  KeyValue(546974,113675),
  KeyValue(547401,913223),
  KeyValue(548365,210064),
  KeyValue(548736,97432),
  KeyValue(548906,583063),
  KeyValue(549228,282593),
  KeyValue(549302,997176),
  KeyValue(549478,896504),
  KeyValue(549515,992178),
  KeyValue(549813,284081),
  KeyValue(551829,382968),
  KeyValue(555452,585027),
  KeyValue(556835,813265),
  KeyValue(557610,670468),
  KeyValue(559108,408672),
  KeyValue(560324,642325),
  KeyValue(561133,361192),
  KeyValue(562306,91840),
  KeyValue(563983,685164),
  KeyValue(564898,141819),
  KeyValue(565690,745794),
  KeyValue(566182,202449),
  KeyValue(568631,959515),
  KeyValue(569339,487211),
  KeyValue(571582,495125),
  KeyValue(571626,246300),
  KeyValue(571654,153719),
  KeyValue(571891,80655),
  KeyValue(572806,541534),
  KeyValue(573182,55606),
  KeyValue(573400,641374),
  KeyValue(574360,976115),
  KeyValue(575679,339119),
  KeyValue(576637,301218),
  KeyValue(576775,713546),
  KeyValue(577775,695637),
  KeyValue(579862,420038),
  KeyValue(580969,666364),
  KeyValue(582117,30379),
  KeyValue(585674,440268),
  KeyValue(586015,380114),
  KeyValue(586861,869494),
  KeyValue(587988,553911),
  KeyValue(588119,310738),
  KeyValue(589419,934110),
  KeyValue(589708,716938),
  KeyValue(591588,753173),
  KeyValue(591714,22168),
  KeyValue(594159,992419),
  KeyValue(595927,444850),
  KeyValue(596702,332694),
  KeyValue(596723,941428),
  KeyValue(596947,228571),
  KeyValue(597476,413494),
  KeyValue(597956,972963),
  KeyValue(598216,56440),
  KeyValue(598779,703849),
  KeyValue(599194,399214),
  KeyValue(600132,382316),
  KeyValue(601637,919236),
  KeyValue(602006,11578),
  KeyValue(602249,144142),
  KeyValue(603359,592705),
  KeyValue(605639,401832),
  KeyValue(606001,171155),
  KeyValue(608019,747700),
  KeyValue(609468,793872),
  KeyValue(611110,597168),
  KeyValue(612057,251955),
  KeyValue(613926,924829),
  KeyValue(614125,351318),
  KeyValue(614501,494116),
  KeyValue(616350,630488),
  KeyValue(616563,764063),
  KeyValue(621045,484180),
  KeyValue(622813,50492),
  KeyValue(623242,602405),
  KeyValue(624005,331803),
  KeyValue(626861,385769),
  KeyValue(627998,841948),
  KeyValue(629269,319249),
  KeyValue(629543,868247),
  KeyValue(629571,764004),
  KeyValue(631763,802084),
  KeyValue(631842,329900),
  KeyValue(632738,951367),
  KeyValue(632938,577059),
  KeyValue(633429,669520),
  KeyValue(634619,124390),
  KeyValue(634717,219410),
  KeyValue(636321,418672),
  KeyValue(639523,997598),
  KeyValue(641375,379582),
  KeyValue(641665,428609),
  KeyValue(642978,274209),
  KeyValue(643026,730448),
  KeyValue(644389,653873),
  KeyValue(645345,620672),
  KeyValue(646495,639057),
  KeyValue(648075,728306),
  KeyValue(648154,414449),
  KeyValue(651253,126712),
  KeyValue(651294,412247),
  KeyValue(651514,251422),
  KeyValue(652046,147774),
  KeyValue(652058,886990),
  KeyValue(652465,745264),
  KeyValue(652621,562602),
  KeyValue(653918,91964),
  KeyValue(654628,894963),
  KeyValue(658064,39),
  KeyValue(658593,581285),
  KeyValue(658614,439320),
  KeyValue(659887,834691),
  KeyValue(661177,213819),
  KeyValue(661355,517145),
  KeyValue(661425,370837),
  KeyValue(661993,47638),
  KeyValue(664345,190257),
  KeyValue(664688,266119),
  KeyValue(665503,263620),
  KeyValue(665973,755855),
  KeyValue(666856,291525),
  KeyValue(667049,698558),
  KeyValue(667104,606870),
  KeyValue(667623,679042),
  KeyValue(667965,610737),
  KeyValue(668273,198052),
  KeyValue(668904,903056),
  KeyValue(671079,867119),
  KeyValue(671351,223696),
  KeyValue(671648,838678),
  KeyValue(672738,814224),
  KeyValue(674524,516908),
  KeyValue(674692,96428),
  KeyValue(676065,40),
  KeyValue(676236,671784),
  KeyValue(677832,896095),
  KeyValue(678709,334365),
  KeyValue(678864,47044),
  KeyValue(680561,682494),
  KeyValue(680743,451459),
  KeyValue(681198,628766),
  KeyValue(681346,150335),
  KeyValue(681656,807739),
  KeyValue(681665,671903),
  KeyValue(682049,667679),
  KeyValue(683364,721585),
  KeyValue(683909,752405),
  KeyValue(683946,197517),
  KeyValue(686430,777038),
  KeyValue(686772,417485),
  KeyValue(687414,82506),
  KeyValue(687577,382619),
  KeyValue(688455,15867),
  KeyValue(689134,458480),
  KeyValue(689707,944647),
  KeyValue(690931,33003),
  KeyValue(693926,642095),
  KeyValue(695679,991533),
  KeyValue(696995,650127),
  KeyValue(698460,737174),
  KeyValue(699029,941078),
  KeyValue(699639,437240),
  KeyValue(699791,836597),
  KeyValue(701190,415999),
  KeyValue(702206,688980),
  KeyValue(702279,244225),
  KeyValue(702471,416475),
  KeyValue(702989,329666),
  KeyValue(703331,815297),
  KeyValue(706461,699690),
  KeyValue(706535,800720),
  KeyValue(706949,160748),
  KeyValue(708398,771089),
  KeyValue(708478,422961),
  KeyValue(709319,659053),
  KeyValue(709819,26876),
  KeyValue(710450,479782),
  KeyValue(711564,243750),
  KeyValue(715642,869263),
  KeyValue(718919,743126),
  KeyValue(719155,514590),
  KeyValue(719204,779658),
  KeyValue(719794,278795),
  KeyValue(721871,593545),
  KeyValue(722292,785073),
  KeyValue(724963,817440),
  KeyValue(725234,109521),
  KeyValue(725291,350968),
  KeyValue(725411,736224),
  KeyValue(727334,773352),
  KeyValue(728608,513936),
  KeyValue(729747,440038),
  KeyValue(730372,568437),
  KeyValue(732598,216739),
  KeyValue(738162,286591),
  KeyValue(738958,576172),
  KeyValue(740476,715460),
  KeyValue(742002,647095),
  KeyValue(743273,445929),
  KeyValue(744074,145400),
  KeyValue(744580,626152),
  KeyValue(745522,299502),
  KeyValue(746283,969699),
  KeyValue(746679,782992),
  KeyValue(748292,955360),
  KeyValue(748434,687317),
  KeyValue(749251,499955),
  KeyValue(750104,511974),
  KeyValue(750170,998735),
  KeyValue(750524,202817),
  KeyValue(751710,582421),
  KeyValue(752940,696242),
  KeyValue(753336,471753),
  KeyValue(753355,722660),
  KeyValue(753862,279511),
  KeyValue(756410,632638),
  KeyValue(756626,184967),
  KeyValue(757621,297064),
  KeyValue(758245,871884),
  KeyValue(758698,793286),
  KeyValue(759196,384765),
  KeyValue(759697,853380),
  KeyValue(760617,244586),
  KeyValue(762198,910320),
  KeyValue(762343,691126),
  KeyValue(765209,975293),
  KeyValue(765531,456879),
  KeyValue(766313,991834),
  KeyValue(767065,153315),
  KeyValue(769114,359657),
  KeyValue(769360,878191),
  KeyValue(769437,494244),
  KeyValue(770204,761514),
  KeyValue(770617,771450),
  KeyValue(772030,935251),
  KeyValue(773202,425106),
  KeyValue(775880,520960),
  KeyValue(776417,157540),
  KeyValue(776984,84772),
  KeyValue(782130,403687),
  KeyValue(782474,7007),
  KeyValue(783865,776865),
  KeyValue(787707,119996),
  KeyValue(791140,114106),
  KeyValue(791156,893365),
  KeyValue(791982,834282),
  KeyValue(792780,482048),
  KeyValue(794277,859213),
  KeyValue(794769,696007),
  KeyValue(794880,11530),
  KeyValue(795352,232866),
  KeyValue(796038,163550),
  KeyValue(797872,813280),
  KeyValue(798450,989635),
  KeyValue(799034,644897),
  KeyValue(803072,621634),
  KeyValue(804912,367394),
  KeyValue(806354,587660),
  KeyValue(806649,467531),
  KeyValue(808309,354305),
  KeyValue(811895,389171),
  KeyValue(812305,986363),
  KeyValue(813046,562611),
  KeyValue(813622,690772),
  KeyValue(815406,690772),
  KeyValue(817316,493295),
  KeyValue(817561,600393),
  KeyValue(819204,21765),
  KeyValue(819527,849278),
  KeyValue(819726,244054),
  KeyValue(821177,681491),
  KeyValue(822300,801560),
  KeyValue(822798,954353),
  KeyValue(823579,387090),
  KeyValue(824697,439330),
  KeyValue(828704,246791),
  KeyValue(828707,708920),
  KeyValue(829331,944596),
  KeyValue(830669,544048),
  KeyValue(830683,563862),
  KeyValue(831096,391493),
  KeyValue(831255,505969),
  KeyValue(831551,729983),
  KeyValue(833377,665308),
  KeyValue(833648,290999),
  KeyValue(833682,285942),
  KeyValue(834338,825836),
  KeyValue(835066,897770),
  KeyValue(835845,676851),
  KeyValue(835997,162958),
  KeyValue(836206,375310),
  KeyValue(836375,416007),
  KeyValue(836419,205261),
  KeyValue(837081,590458),
  KeyValue(838101,356924),
  KeyValue(839159,20458),
  KeyValue(839556,733910),
  KeyValue(841115,424932),
  KeyValue(841510,412080),
  KeyValue(842039,624849),
  KeyValue(843975,246733),
  KeyValue(844201,776393),
  KeyValue(844640,69366),
  KeyValue(845575,587186),
  KeyValue(845981,591113),
  KeyValue(846325,124284),
  KeyValue(848695,201216),
  KeyValue(851649,882302),
  KeyValue(853798,368349),
  KeyValue(854236,81326),
  KeyValue(855082,351392),
  KeyValue(856876,561483),
  KeyValue(858511,439510),
  KeyValue(858765,275353),
  KeyValue(859510,376501),
  KeyValue(860225,485325),
  KeyValue(860859,250125),
  KeyValue(861429,94000),
  KeyValue(863360,181880),
  KeyValue(863642,668820),
  KeyValue(864171,748311),
  KeyValue(867514,850530),
  KeyValue(867888,401015),
  KeyValue(867991,391793),
  KeyValue(869013,824232),
  KeyValue(870376,897891),
  KeyValue(871283,391555),
  KeyValue(871826,793054),
  KeyValue(876565,576716),
  KeyValue(879059,710113),
  KeyValue(880784,749145),
  KeyValue(882350,941981),
  KeyValue(883564,51935),
  KeyValue(884707,631634),
  KeyValue(885648,131188),
  KeyValue(886351,886171),
  KeyValue(886510,404765),
  KeyValue(886599,483601),
  KeyValue(888572,999457),
  KeyValue(890018,865882),
  KeyValue(890452,454565),
  KeyValue(890737,554583),
  KeyValue(892149,993805),
  KeyValue(896523,635205),
  KeyValue(897244,91800),
  KeyValue(897656,814416),
  KeyValue(897914,813048),
  KeyValue(899267,227756),
  KeyValue(899521,143684),
  KeyValue(901217,919491),
  KeyValue(901673,28375),
  KeyValue(901996,757833),
  KeyValue(902303,778181),
  KeyValue(902493,168435),
  KeyValue(903301,163081),
  KeyValue(906706,287850),
  KeyValue(908921,679592),
  KeyValue(910852,481877),
  KeyValue(913002,841667),
  KeyValue(913817,277081),
  KeyValue(914368,17785),
  KeyValue(915687,20403),
  KeyValue(916633,199554),
  KeyValue(917847,546136),
  KeyValue(917977,445107),
  KeyValue(919118,281544),
  KeyValue(920252,783002),
  KeyValue(920829,5588),
  KeyValue(920935,688041),
  KeyValue(923061,909973),
  KeyValue(925503,589809),
  KeyValue(928527,208123),
  KeyValue(929321,33077),
  KeyValue(929890,818107),
  KeyValue(930436,588976),
  KeyValue(930975,503357),
  KeyValue(931674,808944),
  KeyValue(931914,468074),
  KeyValue(932843,740758),
  KeyValue(933005,409765),
  KeyValue(934692,679296),
  KeyValue(935241,389060),
  KeyValue(935935,4815),
  KeyValue(936608,814418),
  KeyValue(939725,372519),
  KeyValue(939871,525670),
  KeyValue(940163,460697),
  KeyValue(942069,343424),
  KeyValue(944192,809123),
  KeyValue(944452,627830),
  KeyValue(944752,720767),
  KeyValue(944810,633542),
  KeyValue(945250,159216),
  KeyValue(945962,430353),
  KeyValue(946044,795855),
  KeyValue(947545,952159),
  KeyValue(949157,124944),
  KeyValue(949394,925623),
  KeyValue(952430,278928),
  KeyValue(954028,552862),
  KeyValue(954291,688400),
  KeyValue(954414,987145),
  KeyValue(954651,43491),
  KeyValue(955408,590108),
  KeyValue(955515,318376),
  KeyValue(958214,785622),
  KeyValue(960054,50393),
  KeyValue(960955,41884),
  KeyValue(961095,464030),
  KeyValue(961436,127087),
  KeyValue(961920,292494),
  KeyValue(963160,238410),
  KeyValue(965836,899206),
  KeyValue(966909,987324),
  KeyValue(967037,828164),
  KeyValue(969220,574699),
  KeyValue(970086,266613),
  KeyValue(970298,827927),
  KeyValue(973101,958706),
  KeyValue(973193,656272),
  KeyValue(973346,123637),
  KeyValue(974240,21656),
  KeyValue(974347,114474),
  KeyValue(974467,108048),
  KeyValue(975399,629141),
  KeyValue(975880,390966),
  KeyValue(977180,442790),
  KeyValue(977238,861187),
  KeyValue(982168,801629),
  KeyValue(982550,247038),
  KeyValue(983235,191823),
  KeyValue(984921,977984),
  KeyValue(985431,565061),
  KeyValue(986729,780209),
  KeyValue(986882,57475),
  KeyValue(987430,667518),
  KeyValue(989362,450347),
  KeyValue(994661,71636),
  KeyValue(995400,670196),
  KeyValue(998290,233950),
  KeyValue(999092,999999),
};

  int size = 1000;

  std::vector<int> values(size,0);
  // Acutally run the kernel

  values.clear();
  values.resize(size);
  bin_search_mtpull( &values[0], keys, size, kv, kv_sz );
  verify_results( "mtpull", &values[0], ref, size );

  return 0;
}
